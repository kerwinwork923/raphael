import{u as _,r as p,o as g,v as i,x as d,A as k,y as o,H as f,S as C,C as R,z as u,N as y,V as b,I as N,a4 as L}from"./HfdH-K36.js";import{_ as T}from"./Y-KACby9.js";import{C as S}from"./zbPE8Z49.js";import{u as w}from"./O0ivr2ua.js";import{u as A}from"./BdfeuyLY.js";import{_ as $}from"./DlAUqK2U.js";const x=""+new URL("goNextRed.C7Lq6Gyi.svg",import.meta.url).href,G={class:"payMethodWrap"},V={class:"payMethodTitleGroup"},H={class:"payMethodGroup"},K={class:"payMethodTitle"},O={class:"payMethodContent"},P=["id","value"],B=["for"],z=["onClick"],F={key:0,class:"payMethodHR"},q={key:0,class:"btnGroup"},U={__name:"payMethod",setup(E){const v=_(),s=JSON.parse(localStorage.getItem("userData")),r=p([]),m=p(null),l=p(""),c=w(),h=async function(){var n,t,a;try{const{data:e}=await A("https://23700999.com:8081/HMA/api/fr/maGetRelated",{method:"POST",body:{MID:s.MID,Token:s.Token,MAID:s.MAID,Mobile:s.Mobile,Lang:"zhtw"}},"$AZFAN8LTnK");((n=e.value)==null?void 0:n.Result)==="OK"&&((t=e.value)!=null&&t.CRNameList&&(r.value=e.value.CRNameList,r.value.length>0&&(c.selectedAddressId?l.value=c.selectedAddressId:l.value=r.value[0].AID)),(a=e.value)!=null&&a.DeliverList&&e.value.DeliverList.length>0&&(m.value=e.value.DeliverList[0]))}catch(e){console.error("獲取相關資料失敗：",e)}},D=async n=>{var t,a;if(confirm("確定要刪除此地址嗎？"))try{const{data:e}=await A("https://23700999.com:8081/HMA/api/fr/maDeleteCName",{method:"POST",body:{MID:s.MID,Token:s.Token,MAID:s.MAID,Mobile:s.Mobile,Lang:"zhtw",AID:n}},"$1bKakKdPkq");((t=e.value)==null?void 0:t.Result)==="OK"?(console.log("地址刪除成功"),await h()):alert(`刪除地址失敗: ${((a=e.value)==null?void 0:a.Message)||"未知錯誤"}`)}catch(e){console.error("刪除地址失敗：",e),alert("刪除地址時發生錯誤")}},I=()=>{if(!l.value){alert("請選擇收件地址");return}c.setSelectedAddress(l.value),console.log("已儲存的地址AID至Pinia：",l.value),v.push("/cart/pay")};return g(()=>{h()}),(n,t)=>{var a;return d(),i("div",G,[k(S,{title:"寄送方式",backPath:"/cart/pay"}),o("div",V,[t[3]||(t[3]=o("h5",null,"支援物流",-1)),o("h6",{onClick:t[0]||(t[0]=e=>C(v).push("/cart/addAddress"))},t[2]||(t[2]=[R("新增地址 "),o("img",{src:x,alt:""},null,-1)]))]),o("div",H,[o("div",K,[o("h4",null,u(((a=m.value)==null?void 0:a.Name)||"宅配"),1),t[4]||(t[4]=o("h5",null,"免運費",-1))]),t[7]||(t[7]=o("p",null,"預計送達時間 5月20日~5月25日",-1)),(d(!0),i(y,null,b(r.value,e=>(d(),i(y,{key:e.AID},[t[6]||(t[6]=o("div",{class:"payMethodHR"},null,-1)),o("div",O,[N(o("input",{type:"radio",name:"payMethod",id:`payMethod${e.AID}`,value:e.AID,"onUpdate:modelValue":t[1]||(t[1]=M=>l.value=M)},null,8,P),[[L,l.value]]),o("label",{for:`payMethod${e.AID}`},[o("h4",null,u(e.RName),1),o("h5",null,u(e.RMobile),1),o("h5",null,u(e.Address),1)],8,B),o("div",{class:"delete",onClick:M=>D(e.AID)},t[5]||(t[5]=[o("img",{src:T,alt:""},null,-1)]),8,z)])],64))),128)),r.value.length>0?(d(),i("div",F)):f("",!0)]),r.value.length>0?(d(),i("div",q,[o("button",{onClick:I},"確認")])):f("",!0)])}}},Y=$(U,[["__scopeId","data-v-4be10a0e"]]);export{Y as default};
