import{_ as O}from"./1SqYRxzD.js";import{u as $,_ as F,a as j}from"./DgKdE7NY.js";import{M as K,j as C,r,v as u,x as c,y as e,I as D,A as G,H as B,N as S,V as z,L as J,z as l,C as P,K as V}from"./HfdH-K36.js";import{a as Q}from"./xsH4HHeE.js";import{u as q}from"./BUsOIeYI.js";import"./DlAUqK2U.js";import"./C7_Xho3L.js";const W="data:image/svg+xml,%3csvg%20width='357'%20height='124'%20viewBox='0%200%20357%20124'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20filter='url(%23filter0_d_10861_119182)'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M10%2016C10%2011.5817%2013.5817%208%2018%208H339C343.418%208%20347%2011.5817%20347%2016V43.5815C346.674%2043.5611%20346.346%2043.5508%20346.015%2043.5508C337.308%2043.5508%20330.249%2050.7142%20330.249%2059.5508C330.249%2068.3873%20337.308%2075.5508%20346.015%2075.5508C346.346%2075.5508%20346.674%2075.5404%20347%2075.5201V104C347%20108.418%20343.418%20112%20339%20112H18C13.5817%20112%2010%20108.418%2010%20104V75.5508H10.0004C18.7077%2075.5508%2025.7664%2068.3873%2025.7664%2059.5508C25.7664%2050.7142%2018.7077%2043.5508%2010.0004%2043.5508H10V16Z'%20fill='white'/%3e%3c/g%3e%3cdefs%3e%3cfilter%20id='filter0_d_10861_119182'%20x='0'%20y='0'%20width='357'%20height='124'%20filterUnits='userSpaceOnUse'%20color-interpolation-filters='sRGB'%3e%3cfeFlood%20flood-opacity='0'%20result='BackgroundImageFix'/%3e%3cfeColorMatrix%20in='SourceAlpha'%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%20127%200'%20result='hardAlpha'/%3e%3cfeOffset%20dy='2'/%3e%3cfeGaussianBlur%20stdDeviation='5'/%3e%3cfeComposite%20in2='hardAlpha'%20operator='out'/%3e%3cfeColorMatrix%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200.25%200'/%3e%3cfeBlend%20mode='normal'%20in2='BackgroundImageFix'%20result='effect1_dropShadow_10861_119182'/%3e%3cfeBlend%20mode='normal'%20in='SourceGraphic'%20in2='effect1_dropShadow_10861_119182'%20result='shape'/%3e%3c/filter%3e%3c/defs%3e%3c/svg%3e",A=""+new URL("pointGift.WpQ4XJSI.png",import.meta.url).href,X="data:image/svg+xml,%3csvg%20width='2'%20height='86'%20viewBox='0%200%202%2086'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='line'%20d='M1%200.5V85.5'%20stroke='%23CCCCCC'%20stroke-linejoin='round'%20stroke-dasharray='7%207'/%3e%3c/svg%3e",Z={class:"memberPointExange"},Y={class:"hasCoupon"},ee={class:"couponsGroup"},se=["onClick"],oe={class:"couponContent"},te={class:"couponText"},ne={class:"couponOption"},le={key:0},ie={class:"couponSmallInfoGroup"},ae={key:0},re={key:0,class:"exangeBox"},ue={class:"exchangeBoxText"},ce={class:"exchangeBoxList1"},de={class:"exchangeBoxList2"},ve={class:"exchangeBoxList3"},pe={class:"verificationBox"},me={class:"verificationNumberGroup"},fe={class:"verificationNumber"},ke={__name:"pointExange",setup(xe){q({title:"",description:"NeuroPlus神經調節家提供專業的自律神經檢測服務，運用FDA認證AI技術，透過人臉辨識快速分析HRV數據，幫助您了解自律神經狀態。",url:"https://neuroplus.com.tw"});const E=K(),f=$(),L=C(()=>f.bonusPaperList),v=r(!1),t=r(null),x=r(!1),d=r(!1),g=r(""),_=r(""),h=C(()=>{const s=(f.nowAvaPoints||"").match(/\d+/);return s?Number(s[0]):0}),R=C(()=>{if(!t.value)return h.value;const o=Number(t.value.Points)||0;return h.value-o}),w=localStorage.getItem("userData"),{MID:N,Token:k,MAID:I,Mobile:b}=w?JSON.parse(w):{};(!N||!k||!I||!b)&&E.push("/");function p(o){if(!o)return{money:"",text:""};const[s,a]=o.split("#");return{money:s,text:a}}function T(o){o.Info==="已兌換"||o.Info.includes("還差")||(t.value=o,v.value=!0,d.value=!0)}function m(){v.value=!1,d.value=!1,t.value=null}function M(){x.value=!1,d.value=!1,v.value=!1,t.value=null,g.value="",_.value=""}async function y(){var o,s;try{const a={MID:N,Token:k,MAID:I,Mobile:b,Points:t.value.Points,CanUseTime:t.value.CanUseTime,Grade:t.value.Grade,PaperName:t.value.Name,Period:t.value.Period,DMoney:t.value.DMoney},{data:n}=await Q.post("https://23700999.com:8081/HMA/API_Exchange.jsp",a);if((n==null?void 0:n.Result)==="OK"&&((o=n==null?void 0:n.BonusPaper)==null?void 0:o.Ret)==="OK"){g.value=n.BonusPaper.DigitalCode,_.value=n.BonusPaper.PaperName;const i=n.BonusPaper.NowPoints;f.nowAvaPoints=`累積積分${i}點`,m(),x.value=!0,d.value=!0}else alert("兌換失敗："+(((s=n==null?void 0:n.BonusPaper)==null?void 0:s.Ret)||"不明原因")),m()}catch(a){console.error(a),alert("兌換時發生錯誤："+a.message),m()}}function H(o){return o?`${o.slice(0,4)}/${o.slice(4,6)}/${o.slice(6,8)}`:""}return(o,s)=>{const a=O,n=F;return c(),u(S,null,[e("div",Z,[G(a,{Text:"積分兌換",link:"/point"}),s[15]||(s[15]=e("div",{class:"memberPointExangeMB"},null,-1)),G(n),e("div",Y,[s[3]||(s[3]=e("h3",null,"目前積分可兌換",-1)),e("div",ee,[(c(!0),u(S,null,z(L.value,(i,U)=>(c(),u("div",{class:J(["coupon",{couponExchanged:i.Info==="已兌換",couponNot:i.Info.includes("還差")}]),key:U,onClick:ge=>T(i)},[s[2]||(s[2]=e("img",{src:W,alt:"券底圖"},null,-1)),e("div",oe,[s[0]||(s[0]=e("div",{class:"couponGift"},[e("img",{src:A,alt:"禮物圖"})],-1)),s[1]||(s[1]=e("div",{class:"couponLine"},[e("img",{src:X,alt:"分割線"})],-1)),e("div",te,[e("h4",null,l(p(i.Name).money),1),e("h5",null,l(p(i.Name).text),1)]),e("div",ne,[e("h4",null,l(i.Points)+"點",1),i.Info.includes("兌換")?(c(),u("small",le,l(i.Info),1)):B("",!0)]),e("div",ie,[e("small",null,"有效期限 : "+l(i.Period)+" 個月 ",1),i.Info.includes("還差")?(c(),u("small",ae,l(i.Info),1)):B("",!0)])])],10,se))),128))])]),v.value?(c(),u("div",re,[s[8]||(s[8]=e("h3",null,"兌換確認",-1)),s[9]||(s[9]=e("div",{class:"exangeBoxHR"},null,-1)),s[10]||(s[10]=e("div",{class:"exangeBoxImgGroup"},[e("img",{src:A,alt:""})],-1)),e("h4",null,l(p(t.value.Name).money)+" "+l(p(t.value.Name).text),1),e("div",ue,[s[7]||(s[7]=e("small",null,"可用於療程商品折抵",-1)),e("h6",null,"有效期限 : "+l(H(t.value.CanUseTime))+"+6個月",1),e("ul",null,[e("li",null,[s[4]||(s[4]=P(" 目前積分 ")),e("span",ce,l(h.value)+"點 ",1)]),e("li",null,[s[5]||(s[5]=P(" 兌換積分 ")),e("span",de,l(t.value.Points)+"點 ",1)]),e("li",null,[s[6]||(s[6]=P(" 剩餘積分 ")),e("span",ve,l(R.value)+"點 ",1)])])]),s[11]||(s[11]=e("div",{class:"exangeUseInfo"},[e("h5",null,"使用須知"),e("ul",null,[e("li",null,"鈦金會員可立即使用 QR Code 進行使用或下次使用"),e("li",null,"其他會員僅可下次使用"),e("li",null,"兌換後無法更改使用方式，請謹慎選擇")])],-1)),e("div",{class:"exchangeBtnGroup"},[e("button",{onClick:m},"返回"),e("button",{class:"exchangeBtn",onClick:y},"兌換")])])):B("",!0),D(e("div",pe,[e("div",me,[e("div",fe,l(g.value),1)]),e("h4",null,l(_.value.replace("#"," ")),1),s[13]||(s[13]=e("h5",null,"可用於療程商品折抵",-1)),e("div",{onClick:M,class:"verificationClose"},s[12]||(s[12]=[e("img",{src:j,alt:""},null,-1)])),s[14]||(s[14]=e("h6",null,"結帳時向諮詢師出示此畫面 即可折抵消費。",-1))],512),[[V,x.value]])]),D(e("div",{class:"pointCover",onClick:M},null,512),[[V,d.value]])],64)}}};export{ke as default};
