import{H as I}from"./DncpXueh.js";import{_ as Y}from"./-OuEz4cf.js";import{D as S}from"./BWZ9gJ2c.js";import{r as g,J as Z,o as q,i as h,v as i,z as y,M as X,K as D,x as t,y as c,Q as x,T as M,L as p,U as R,t as r,B as b,O as A}from"./D70xjexz.js";import{a as $}from"./D7B7LOx5.js";import{u as tt}from"./t-MFjoUR.js";import{u as et,_ as ot}from"./9hpkcfO1.js";import{_ as w}from"./CR27s-ts.js";import{_ as st}from"./fh2N3Yhm.js";import{_ as nt}from"./DlAUqK2U.js";import"./DNAPM-2u.js";import"./CCb-kr4I.js";const at=""+new URL("faceIcon.BmxQbQek.svg",import.meta.url).href,lt={components:{RaphaelLoading:Y,HRVAlert:I,DSPRSelect:S},setup(){const k=g([]),s=Z(),d=JSON.parse(localStorage.getItem("userData")),o=g(new Date().getFullYear()),P=g(new Date().getMonth()+1),m=g(!1),u=g(!1),l=g(1),_=10,e=tt(),C=Array.from({length:12},(n,a)=>a+1).reverse(),B=g(!1);et(),q(async()=>{try{B.value=!0;const n=await fetch("https://23700999.com:8081/HMA/API_HRV2.jsp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({MID:d.MID,MAID:d.MAID,Token:d.Token,Mobile:d.Mobile})});if(n.ok){const a=await n.json();k.value=a.HRV2}else console.error("Response not OK",n.status)}catch(n){console.error("Error fetching data",n)}finally{B.value=!1}});const H=h(()=>k.value.filter(n=>{const a=new Date(n.CheckTime);return a.getFullYear()===o.value&&a.getMonth()+1===P.value})),T=h(()=>{const n=new Date().getFullYear(),a=2024,f=[];for(let v=a;v<=n;v++)f.push(v);return f});function G(){m.value=!m.value,u.value=!1}function L(){u.value=!u.value,m.value=!1}function F(n){o.value=n,m.value=!1}function N(n){P.value=n,u.value=!1}const O=h(()=>{const n=(l.value-1)*_,a=n+_;return H.value.slice(n,a)}),V=h(()=>Math.ceil(H.value.length/_)),j=h(()=>{const n=[],a=Math.max(l.value-1,1),f=Math.min(l.value+1,V.value);for(let v=a;v<=f;v++)n.push(v);return n});function J(){l.value=1}function Q(){l.value=V.value}function U(n){l.value=n}function z(){l.value<V.value&&l.value++}function E(){l.value>1&&l.value--}function K(n,a){return n>=0&&n<=29?a==="M"?[29,53]:[30,57]:n>=30&&n<=39?a==="M"?[25,47]:[25,44]:n>=40&&n<=49?a==="M"?[21,40]:[20,40]:n>=50&&n<=59?a==="M"?[15,34]:[18,38]:n>=60?a==="M"?[16,33]:[15,30]:[0,1/0]}function W(n){const a=d.Birthday?new Date().getFullYear()-new Date(d.Birthday).getFullYear():0,f=K(a,d.Sex);return n<f[0]}return{filteredHRVData:H,selectedYear:o,selectedMonth:P,displayYears:T,months:C,formatTimestampMDH:$,isHRVBelowAverage:W,toggleYearBox:G,toggleMonthBox:L,selectYear:F,selectMonth:N,yearBoxVisible:m,monthBoxVisible:u,currentPage:l,totalPages:V,displayedPages:j,nextPage:z,prevPage:E,firstPage:J,lastPage:Q,changePage:U,paginatedData:O,goBack:()=>{s.push("/HRVHistory")},openHRVAlert:async()=>{localStorage.removeItem("form"),e.showHRVAlert=!0},loading:B}}},rt={class:"HRVHistoryAll"},it={class:"titleGroup"},ct={class:"detectWrap"},dt={class:"detectSelectGroup"},ut={class:"yearSelectGroup"},vt={class:"yearBox"},gt=["onClick"],mt={class:"monthSelectGroup"},ft={class:"monthBox"},_t=["onClick"],ht={class:"detectList"},pt=["href"],Pt={class:"timeGroup"},Ct={class:"time"},Vt={class:"infoGroup"},Rt={class:"detectAgeGroup"},kt={class:"detectHRVGroup"},Bt={key:0,class:"notDetectData"},Ht={class:"paginationWrap"},yt={class:"preBtnGroup"},Dt=["disabled"],xt=["disabled"],Mt={class:"paginationCenter"},bt=["onClick"],At={class:"nextBtnGroup"},wt=["disabled"],It=["disabled"],Yt={class:"itemsGroup"};function St(k,s,d,o,P,m){const u=I,l=Y,_=S;return r(),i(p,null,[y(u),o.loading?(r(),X(l,{key:0})):D("",!0),y(_),t("div",rt,[t("div",it,[t("img",{src:ot,alt:"",onClick:s[0]||(s[0]=(...e)=>o.goBack&&o.goBack(...e))}),s[8]||(s[8]=t("h2",null,"HRV 檢測歷史紀錄",-1))]),t("div",ct,[t("div",dt,[t("div",ut,[s[9]||(s[9]=t("img",{src:w,alt:""},null,-1)),t("div",{class:"monthText",onClick:s[1]||(s[1]=(...e)=>o.toggleYearBox&&o.toggleYearBox(...e))},c(o.selectedYear)+"年 ",1),x(t("div",vt,[(r(!0),i(p,null,R(o.displayYears,e=>(r(),i("div",{class:"year",key:e,onClick:C=>o.selectYear(e)},c(e),9,gt))),128))],512),[[M,o.yearBoxVisible]])]),t("div",mt,[s[10]||(s[10]=t("img",{src:w,alt:""},null,-1)),t("div",{class:"monthText",onClick:s[2]||(s[2]=(...e)=>o.toggleMonthBox&&o.toggleMonthBox(...e))},c(o.selectedMonth)+"月份 ",1),x(t("div",ft,[(r(!0),i(p,null,R(o.months,e=>(r(),i("div",{class:"month",key:e,onClick:C=>o.selectMonth(e)},c(e)+"月 ",9,_t))),128))],512),[[M,o.monthBoxVisible]])])]),t("div",ht,[(r(!0),i(p,null,R(o.paginatedData,e=>(r(),i("div",{class:"detectItem",key:e.AID},[t("a",{href:`/vital/detail.html?AID=${e.AID}`},[t("div",Pt,[s[11]||(s[11]=t("div",{class:"timeIcon"},[t("img",{src:st,alt:""})],-1)),t("div",Ct,[t("h6",null,c(o.formatTimestampMDH(e.CheckTime)),1),t("small",null,c(e==null?void 0:e.ProductName)+" "+c(e==null?void 0:e.Flag),1)])]),t("div",Vt,[t("div",Rt,[s[13]||(s[13]=t("h4",null,"生理年齡",-1)),t("h5",null,[t("span",null,c(e.bioage),1),s[12]||(s[12]=b("歲 "))])]),t("div",kt,[s[15]||(s[15]=t("h4",null,"HRV",-1)),t("h5",{class:A({redValue:o.isHRVBelowAverage(e.HRV)})},[t("span",null,c(Math.round(e.HRV*10)/10),1),s[14]||(s[14]=b("ms "))],2)]),s[16]||(s[16]=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 18 18",fill:"none"},[t("path",{d:"M5.99159 3.37719L11.4726 8.99994L5.99159 14.6227C5.89346 14.7232 5.83853 14.858 5.83853 14.9984C5.83853 15.1389 5.89346 15.2737 5.99159 15.3742C6.03925 15.4228 6.09613 15.4615 6.15891 15.4879C6.2217 15.5142 6.28911 15.5278 6.35721 15.5278C6.42531 15.5278 6.49273 15.5142 6.55551 15.4879C6.61829 15.4615 6.67518 15.4228 6.72284 15.3742L12.5548 9.39257C12.6572 9.28752 12.7145 9.14664 12.7145 8.99994C12.7145 8.85325 12.6572 8.71236 12.5548 8.60732L6.72396 2.62569C6.67627 2.57671 6.61924 2.53777 6.55625 2.51119C6.49326 2.4846 6.42558 2.4709 6.35721 2.4709C6.28884 2.4709 6.22116 2.4846 6.15817 2.51119C6.09518 2.53777 6.03816 2.57671 5.99046 2.62569C5.89234 2.72615 5.8374 2.86101 5.8374 3.00144C5.8374 3.14187 5.89234 3.27673 5.99046 3.37719L5.99159 3.37719Z",fill:"#666666"})],-1))])],8,pt)]))),128)),o.filteredHRVData.length===0?(r(),i("div",Bt," 無檢測資料 ")):D("",!0)])]),t("div",Ht,[t("div",yt,[t("button",{class:"firstPageBtn",onClick:s[3]||(s[3]=(...e)=>o.firstPage&&o.firstPage(...e)),disabled:o.currentPage===1}," << ",8,Dt),t("button",{class:"prevPageBtn",onClick:s[4]||(s[4]=(...e)=>o.prevPage&&o.prevPage(...e)),disabled:o.currentPage===1}," < ",8,xt)]),t("div",Mt,[(r(!0),i(p,null,R(o.displayedPages,e=>(r(),i("button",{key:e,onClick:C=>o.changePage(e),class:A({activePage:e===o.currentPage})},c(e),11,bt))),128))]),t("div",At,[t("button",{class:"nextPageBtn",onClick:s[5]||(s[5]=(...e)=>o.nextPage&&o.nextPage(...e)),disabled:o.currentPage===o.totalPages}," > ",8,wt),t("button",{class:"lastPageBtn",onClick:s[6]||(s[6]=(...e)=>o.lastPage&&o.lastPage(...e)),disabled:o.currentPage===o.totalPages}," >> ",8,It)])]),t("div",Yt,[t("div",{class:"item",onClick:s[7]||(s[7]=(...e)=>o.openHRVAlert&&o.openHRVAlert(...e))},s[17]||(s[17]=[t("div",{class:"topTitle"},"檢測",-1),t("div",{class:"bottomTitle"},"HRV",-1),t("img",{src:at,alt:""},null,-1)]))])])],64)}const qt=nt(lt,[["render",St],["__scopeId","data-v-2be2befc"]]);export{qt as default};
