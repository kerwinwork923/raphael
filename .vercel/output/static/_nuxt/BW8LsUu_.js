import{_ as G}from"./-OuEz4cf.js";import{a0 as N,a1 as S,a2 as x,r,J as H,o as B,g as W,v as O,M as R,K as U,x as s,y as j,Q as f,R as q,$ as z,z as y,A as v,t as C,B as J}from"./D70xjexz.js";import{a as h}from"./CCb-kr4I.js";import{e as K,a as Z,_ as F,b as X,c as E}from"./CpRiLZbI.js";import{_ as Y}from"./DlAUqK2U.js";const g={value:""},Q={apiKey:"AIzaSyDqLTG4RULhejwmTcoWqhYHWX4rryk5Z-8",authDomain:"neuroplus-4338a.firebaseapp.com",databaseURL:"https://neuroplus-4338a-default-rtdb.firebaseio.com/",projectId:"neuroplus-4338a",storageBucket:"gs://neuroplus-4338a.appspot.com/",messagingSenderId:"13238098998",appId:"1:13238098998:ios:7d30bc142be6421b9b4c97",measurementId:"G-35F5RSTVMZ"},$=N(Q),o2=S($);async function s2(){if(!window.Notification){console.warn("Notifications are not supported in this browser.");return}window.Notification.permission==="granted"?await _():window.Notification.permission==="default"&&await window.Notification.requestPermission()==="granted"?await _():b()}function b(){alert("您已拒絕推播通知。請在瀏覽器的設置中允許通知，才能接收最新消息。")}async function _(){try{const a=await x(o2,{vapidKey:"BNWMTU1y0LLsXXBP_q7atol3ya8wH4EYk74um6OVD3JwU6arjpBzU33G6pHudatw1zbFh6xbJowa4OGy4Wo_85A"});a?(g.value=a,await e2(a)):console.warn("No registration token available. Request permission to generate one.")}catch(a){console.error("Failed to get token:",a)}}async function e2(a){try{await fetch("/api/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:a})})}catch(o){console.error("Failed to send token to server:",o)}}const t2="data:image/svg+xml,%3csvg%20width='21'%20height='22'%20viewBox='0%200%2021%2022'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20id='Group'%3e%3cpath%20id='Vector'%20d='M14.9062%200.5796C14.4469%200.738975%2014.1094%201.08116%2013.95%201.54523C13.8844%201.73741%2013.875%202.05148%2013.875%203.83273V5.89523L13.9922%206.00773C14.1281%206.14835%2014.3391%206.15773%2014.4891%206.03585L14.6016%205.94679L14.625%203.83741C14.6484%201.79835%2014.6531%201.72335%2014.7469%201.59679C14.7984%201.52648%2014.9016%201.42335%2014.9719%201.37179C15.0984%201.27804%2015.1687%201.27335%2017.5875%201.24991L20.0719%201.22647L20.1609%201.11398C20.2828%200.963975%2020.2734%200.753037%2020.1328%200.6171L20.0203%200.499912H17.5687C15.4641%200.5046%2015.0891%200.513975%2014.9062%200.5796Z'%20fill='%23666666'/%3e%3cpath%20id='Vector_2'%20d='M5.96248%206.95C2.20779%209.72968%200.787476%2010.8078%200.768726%2010.8875C0.754663%2010.9484%200.754663%2011.0516%200.768726%2011.1125C0.806226%2011.2719%2011.025%2018.8422%2011.2359%2018.8656C11.3484%2018.8797%2011.414%2018.8562%2011.5031%2018.7625L11.625%2018.6453V16.8828V15.125H15.0703H18.5203L18.6328%2015.0078L18.75%2014.8953V11V7.10468L18.6328%206.99219L18.5203%206.875H15.0703H11.625V5.15937C11.625%203.95%2011.6109%203.41562%2011.5687%203.34531C11.4937%203.2%2011.3859%203.12969%2011.2453%203.125C11.1609%203.125%209.70779%204.175%205.96248%206.95ZM11.0109%207.53594C11.114%207.62031%2011.2453%207.625%2014.5594%207.625H18V11V14.375H14.5547H11.1047L10.9922%2014.4922L10.875%2014.6047V16.1797V17.7547L10.5375%2017.5016C10.35%2017.3656%209.34216%2016.6156%208.29685%2015.8469C2.8031%2011.7781%201.80466%2011.0328%201.80466%2011C1.80466%2010.9672%202.75623%2010.2594%208.36716%206.10156C9.44998%205.3%2010.4531%204.55937%2010.5937%204.45625L10.8515%204.26406L10.875%205.85312L10.8984%207.44687L11.0109%207.53594Z'%20fill='%23666666'/%3e%3cpath%20id='Vector_3'%20d='M13.9922%2015.9921L13.875%2016.1046V18.1624C13.875%2020.464%2013.8797%2020.4968%2014.1984%2020.9187C14.3063%2021.064%2014.475%2021.1999%2014.6719%2021.3078L14.9766%2021.4765L17.4609%2021.4906C19.2984%2021.4999%2019.9688%2021.4906%2020.0484%2021.4484C20.2031%2021.364%2020.2734%2021.1578%2020.2078%2020.989C20.175%2020.9187%2020.1047%2020.8343%2020.0484%2020.8015C19.9781%2020.764%2019.2141%2020.7453%2017.5219%2020.7359C15.1594%2020.7265%2015.0984%2020.7265%2014.9719%2020.6281C14.9016%2020.5765%2014.7984%2020.4734%2014.7469%2020.4031C14.6531%2020.2765%2014.6484%2020.2015%2014.625%2018.1624L14.6016%2016.0531L14.4891%2015.964C14.3391%2015.8421%2014.1281%2015.8515%2013.9922%2015.9921Z'%20fill='%23666666'/%3e%3c/g%3e%3c/svg%3e",a2=""+new URL("download.C3O9wj6z.svg",import.meta.url).href,n2={setup(){const a=r("會員登入"),o=r(!1),u=r(""),e=r(""),c=r(!1),m=H(),d=r(""),p=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,n=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone,P=()=>{c.value=!c.value},L=async()=>{o.value=!0;try{const t=await h.post("https://23700999.com:8081/HMA/API_AA1.jsp",{Mobile:u.value,Password:e.value});if(t.status===200&&t.data.Token.trim()&&t.data.MAID.trim()){console.log("登入成功:",t.data),localStorage.setItem("userData",JSON.stringify(t.data));try{await s2(),d.value=g.value}catch(l){console.warn("Firebase 推播權限失敗",l)}console.log("取得的推播 Token:",d.value),console.log("取得的MAID:",t.data.MAID.trim()),k(t.data.MAID.trim(),g.value),m.push({name:"user"})}else alert(`登入失敗 : ${t.data.Result}`)}catch{alert("登入失敗，請檢查手機號碼和密碼。")}finally{o.value=!1}},k=async(t,l)=>{try{const i=await h.post("https://23700999.com:8081/HMA/API_PushKey.jsp",{MAID:t,PushKey:l});i.status===200?console.log("存儲Pushkey成功:",i.data):alert(`存儲Pushkey失敗 : ${i.data.Result}`)}catch{alert("存儲Pushkey失敗")}},V=async()=>{alert(p&&!n?"在瀏覽器中點擊分享按鈕，然後選擇『加入主畫面』以安裝 APP。":"您的裝置已支援安裝或已安裝，若無法安裝請檢查瀏覽器設置。")};B(()=>{var t,l,i;try{((l=(t=window.matchMedia)==null?void 0:t.call(window,"(display-mode: standalone)"))!=null&&l.matches||(i=window.navigator)!=null&&i.standalone)&&console.log("App 是以 PWA 模式執行")}catch(D){console.warn("PWA 檢查錯誤",D)}});const w=localStorage.getItem("userData"),{MID:M,Token:A,MAID:I,Mobile:T,Name:C2}=w?JSON.parse(w):{};if(M||A||I||T){m.push("/user");return}return{verificationTitle:a,passwordVisible:c,togglePasswordVisibility:P,eyesCloseGreen:K,eyesOpenGreen:Z,loading:o,mobile:u,password:e,login:L,installPWA:V,localMessagingToken:d}}},i2={class:"login"},l2={class:"loginGroup"},r2={class:"raphaelIconImgGroup"},d2={class:"loginWrap"},c2={class:"loginBox"},p2={class:"phoneGroup"},u2={class:"passwordGroup"},m2=["type"],g2=["src"],w2=["disabled"],f2={class:"forgetPasswordGroup"},y2={class:"bottomHintGroup"};function v2(a,o,u,e,c,m){const d=G,p=W("router-link");return C(),O("div",i2,[e.loading?(C(),R(d,{key:0})):U("",!0),s("div",l2,[s("div",r2,[o[6]||(o[6]=s("img",{class:"raphaelIcon",src:F,alt:""},null,-1)),s("h1",null,j(e.verificationTitle),1)]),s("div",d2,[s("div",c2,[s("div",p2,[f(s("input",{type:"tel","onUpdate:modelValue":o[0]||(o[0]=n=>e.mobile=n),placeholder:"請輸入您的手機號碼"},null,512),[[q,e.mobile]]),o[7]||(o[7]=s("img",{class:"icon1",src:X,alt:""},null,-1))]),s("div",u2,[f(s("input",{type:e.passwordVisible?"text":"password","onUpdate:modelValue":o[1]||(o[1]=n=>e.password=n),placeholder:"請輸入密碼(至少8位)",onInput:o[2]||(o[2]=(...n)=>a.validatePassword&&a.validatePassword(...n))},null,40,m2),[[z,e.password]]),o[8]||(o[8]=s("img",{class:"icon1",src:E,alt:""},null,-1)),s("img",{class:"icon2",src:e.passwordVisible?e.eyesOpenGreen:e.eyesCloseGreen,onClick:o[3]||(o[3]=(...n)=>e.togglePasswordVisibility&&e.togglePasswordVisibility(...n)),alt:""},null,8,g2)])]),s("button",{class:"loginBtn",onClick:o[4]||(o[4]=(...n)=>e.login&&e.login(...n)),disabled:!e.mobile||!e.password}," 登入 ",8,w2),s("div",f2,[y(p,{to:"/forgetPassword"},{default:v(()=>o[9]||(o[9]=[J("忘記密碼?")])),_:1})]),s("div",y2,[o[12]||(o[12]=s("div",{class:"separate"},"or",-1)),y(p,{to:"/register"},{default:v(()=>o[10]||(o[10]=[s("img",{class:"icon",src:t2,alt:""},null,-1),s("h5",null,"註冊會員",-1)])),_:1}),s("button",{type:"button",class:"downloadBtn",onClick:o[5]||(o[5]=(...n)=>e.installPWA&&e.installPWA(...n))},o[11]||(o[11]=[s("img",{src:a2},null,-1),s("h5",null,"下載APP",-1)]))])])])])}const k2=Y(n2,[["render",v2],["__scopeId","data-v-dba62474"]]);export{k2 as default};
