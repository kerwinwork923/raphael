import{_ as Te}from"./-OuEz4cf.js";import{_ as we}from"./C4EKiFTB.js";import{u as Be,_ as J,a as Le}from"./DXD00Zig.js";import{J as Ie,r as u,i as p,o as be,a4 as Se,F as re,v as i,M as Ge,K as m,x as e,z as W,B as c,O as S,A as Ae,a3 as De,Q as h,T as f,y as l,L as x,W as Me,t as n,U as _,N as Ne}from"./D70xjexz.js";import{_ as D}from"./CR27s-ts.js";import{a as ce}from"./CCb-kr4I.js";import"./DlAUqK2U.js";import"./C7_Xho3L.js";const Ve=""+new URL("helperIcon.D8_HWr4R.svg",import.meta.url).href,k=""+new URL("todayTaskIcon.-AImVtlS.svg",import.meta.url).href,$e="data:image/svg+xml,%3csvg%20width='18'%20height='18'%20viewBox='0%200%2018%2018'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20id='icon%20/%20check'%3e%3crect%20x='0.5'%20y='0.5'%20width='17'%20height='17'%20rx='8.5'%20stroke='%231FBCB3'/%3e%3cpath%20id='Vector'%20d='M15%205.25L7.5%2012.75L3.75%209'%20stroke='%231FBCB3'%20stroke-width='1.25'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3c/svg%3e",Pe="data:image/svg+xml,%3csvg%20width='16'%20height='16'%20viewBox='0%200%2016%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20id='Group'%3e%3cpath%20id='Vector'%20d='M8%2014.75C11.7279%2014.75%2014.75%2011.7279%2014.75%208C14.75%204.27208%2011.7279%201.25%208%201.25C4.27208%201.25%201.25%204.27208%201.25%208C1.25%2011.7279%204.27208%2014.75%208%2014.75Z'%20stroke='%23666'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20id='Vector_2'%20d='M7.25%205V8.75H11'%20stroke='%23666'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3c/svg%3e",Ue="data:image/svg+xml,%3csvg%20width='16'%20height='16'%20viewBox='0%200%2016%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20id='Group'%3e%3cpath%20id='Vector'%20d='M8%2014.75C11.7279%2014.75%2014.75%2011.7279%2014.75%208C14.75%204.27208%2011.7279%201.25%208%201.25C4.27208%201.25%201.25%204.27208%201.25%208C1.25%2011.7279%204.27208%2014.75%208%2014.75Z'%20stroke='%23FEAC4A'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20id='Vector_2'%20d='M7.25%205V8.75H11'%20stroke='%23FEAC4A'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3c/svg%3e",Ye=""+new URL("pointExchangeGift.BOU5L2D4.svg",import.meta.url).href,Ee=""+new URL("canUse.D3Uo_Yic.svg",import.meta.url).href,Fe=""+new URL("canUseLimit.Cb8VjVED.svg",import.meta.url).href,de=""+new URL("gift.B2y9MFwP.png",import.meta.url).href,je={class:"point"},Oe={class:"helperGroup"},He={class:"pointContentGroup"},qe={class:"pointContentList"},ze={key:0,class:"todayTask"},Ke={class:"todayTaskSubTitle"},Je={class:"todayTaskItemGroup"},We={class:"todayTaskText"},Ze={class:"todayTaskOption"},Qe={class:"todayTaskItemNumber"},Xe={key:0},et={key:1,src:$e,alt:"打勾"},tt={key:0,class:"todayTaskItemButton"},st=["onClick"],ot={key:1,style:{color:"#ec7d7d"}},lt={class:"todayProgressBar"},nt={key:1},it={class:"pointRecordSelectGroup"},at={class:"yearSelectGroup"},ut={class:"yearBox"},rt=["onClick"],ct={class:"monthSelectGroup"},dt={class:"monthBox"},vt=["onClick"],pt={class:"pointRecordGroup"},mt={class:"pointRecordList"},gt={class:"pointRecordText"},ht={key:0},ft={class:"pointRecordNumber"},xt={key:0,class:"notDetectData"},_t={key:2},kt={class:"exchangeRecordSelectGroup"},Rt={class:"yearSelectGroup"},Ct={class:"yearBox"},yt=["onClick"],Tt={class:"monthSelectGroup"},wt={class:"monthBox"},Bt=["onClick"],Lt={class:"exchangeRecordGroup"},It={class:"exchangeRecordList"},bt={class:"exchangeRecordText"},St={key:0,src:Ee,alt:""},Gt={key:1,src:Fe,alt:""},At={class:"exchangeRecordListOption"},Dt=["onClick"],Mt={key:0,class:"notDetectData"},Nt={key:3},Vt={class:"verificationBox"},$t={class:"verificationNumber"},Pt={class:"couponBox"},Ut={class:"couponBoxCompleted"},M=2024,Jt={__name:"point",setup(Yt){const Z=Be(),ve=Ie(),pe=u(!1),r=u("todayTask"),R=u(new Date().getFullYear()),C=u(new Date().getMonth()+1),I=u(new Date().getFullYear()),y=u(new Date().getMonth()+1),T=u(!1),w=u(!1),B=u(!1),L=u(!1),N=u([]),me=u([]),G=u([]);u([]);const V=u(!1),$=u(!1),P=u(!1),U=u(!1),Q=localStorage.getItem("userData"),{MID:Y,Token:E,MAID:F,Mobile:j}=Q?JSON.parse(Q):{};(!Y||!E||!F||!j)&&ve.push("/");const d=u({DigitalCode:"",AvaPoints:"",Name:"",CreateTime:"",UseTime:""});function b(){V.value=!1,$.value=!1,P.value=!1,U.value=!1}function X(s){if(!s)return"";const t=s.replace(/\D/g,"");if(t.length===14){const a=t.slice(0,4),g=t.slice(4,6),K=t.slice(6,8),o=t.slice(8,10),v=t.slice(10,12);return`${a}/${g}/${K} ${o}:${v}`}else return s}function ge(s){if(b(),d.value={DigitalCode:s.DigitalCode,AvaPoints:s.AvaPoints,Name:s.Name,CreateTime:s.CreateTime,Info:s.Info,UseTime:X(s.UseTime)},s.Info.includes("可立即使用"))V.value=!0;else if(s.Info.includes("可使用日")){$.value=!0;const t=s.Info.split(":")[1]||"";d.value.Info=t.trim()}else P.value=!0;U.value=!0}function A(s){r.value=s,s==="exchangeRecord"?H():s==="pointRecord"&&O()}const ee=p(()=>{const s=new Date().getFullYear();return Array.from({length:s-M+1},(t,a)=>M+a)}),he=p(()=>{const s=new Date().getFullYear();return Array.from({length:s-M+1},(t,a)=>M+a)}),te=p(()=>ee.value.reduce((s,t)=>(s[t]=Array.from({length:12},(a,g)=>g+1),s),{})),se=p(()=>te.value[R.value]||[]),oe=p(()=>te.value[I.value]||[]);function le(s){s==="point"?(T.value=!T.value,w.value=!1):s==="exchange"&&(B.value=!B.value,L.value=!1)}function ne(s="point"){s==="exchange"?(L.value=!L.value,B.value=!1):(w.value=!w.value,T.value=!1)}function fe(s,t){R.value=s,C.value=se.value[0]||1,T.value=!1,console.log("Selected "+t+" year:",s)}function ie(s,t){t==="exchange"?(y.value=s,L.value=!1):(C.value=s,w.value=!1),console.log("Selected "+t+" month:",s)}function xe(s){I.value=s,y.value=oe.value[0]||1,B.value=!1,console.log("Selected exchange year:",s)}function ae(s){const t=document.querySelector(".yearBox"),a=document.querySelector(".monthBox");t&&!t.contains(s.target)&&!s.target.closest(".yearSelectGroup")&&(T.value=!1,B.value=!1),a&&!a.contains(s.target)&&!s.target.closest(".monthSelectGroup")&&(w.value=!1,L.value=!1)}async function O(){const s=R.value?String(R.value):"",t=C.value?String(C.value).padStart(2,"0"):"";try{const a=await ce.post("https://23700999.com:8081/HMA/API_BonusRec.jsp",{MID:Y,Token:E,MAID:F,Mobile:j,Yr:s,Mn:t});if(a.status===200&&a.data.Result==="OK"){const g=a.data.BonusRec||{};N.value=g.BonusRecList||[],me.value=g.BonusPaperList||[],console.log("[fetchBonusRec] => ",a.data)}else console.error("[fetchBonusRec] error =>",a)}catch(a){console.error("[fetchBonusRec] catch =>",a)}}async function H(){const s=y.value?String(y.value).padStart(2,"0"):"";try{const t=await ce.post("https://23700999.com:8081/HMA/API_ExchangeRec.jsp",{MID:Y,Token:E,MAID:F,Mobile:j,Yr:String(I.value),Mn:s});if(t.status===200&&t.data.Result==="OK"){const a=t.data.ExchangeRec||{};G.value=a.BonusExchangeList||[],console.log("exchangeRecordList => ",G.value)}}catch(t){console.error(t)}}be(()=>{document.addEventListener("click",ae),O(),H()}),Se(()=>{document.removeEventListener("click",ae)}),re([R,C],()=>{r.value==="pointRecord"&&O()}),re([I,y],()=>{r.value==="exchangeRecord"&&H()});const q=p(()=>Z.taskList);function _e(s){if(s.Info!=="去完成")return;let t="";switch(s.Name){case"使用紀錄":t="/UsageHistory";break;case"自律神經檢測":t="/weekly";break;case"生活紀錄檢測":t="/userRecord";break;case"寶貝記錄檢測":t="/babyRecord";break;default:return}window.open(t,"_blank")}const ue=p(()=>q.value.filter(s=>s.Info==="已經完成").length),z=p(()=>q.value.length),ke=p(()=>z.value?ue.value/z.value*100:0),Re=p(()=>{var s;return((s=Z.nowBonusState)==null?void 0:s.Cando)||0}),Ce=async()=>{r.value="pointRules",await Me();const s=document.querySelector(".pointRulesInfo");s&&s.scrollIntoView({behavior:"smooth"})};return(s,t)=>{const a=Te,g=we,K=Le;return n(),i(x,null,[pe.value?(n(),Ge(a,{key:0})):m("",!0),e("div",je,[W(g,{Text:"獎勵積分",link:"/user"}),e("div",Oe,[e("div",{class:"helper"},[t[8]||(t[8]=e("div",{class:"helperTitle"},[e("img",{src:Ve,alt:""}),c(" 小幫手 ")],-1)),t[9]||(t[9]=e("p",null," 每消費100元獲得1點積分，1點積分等於1元。會員等級越高，積分越多！ 快來累積積分，享受更多回饋！ ",-1)),e("h6",{onClick:Ce},"查看完整積分規則"),t[10]||(t[10]=e("div",{class:"shadowGroup"},[e("div",{class:"shadow1"}),e("div",{class:"shadow2"})],-1))]),W(K,{showExchangeGroup:!0}),e("div",He,[e("div",qe,[e("div",{class:S(["pointContentListItem",{pointContentListItemActive:r.value==="todayTask"}]),onClick:t[0]||(t[0]=o=>A("todayTask"))}," 今日任務 ",2),e("div",{class:S(["pointContentListItem",{pointContentListItemActive:r.value==="pointRecord"}]),onClick:t[1]||(t[1]=o=>A("pointRecord"))}," 積分紀錄 ",2),e("div",{class:S(["pointContentListItem",{pointContentListItemActive:r.value==="exchangeRecord"}]),onClick:t[2]||(t[2]=o=>A("exchangeRecord"))}," 兌換紀錄 ",2),e("div",{class:S(["pointContentListItem",{pointContentListItemActive:r.value==="pointRules"}]),onClick:t[3]||(t[3]=o=>A("pointRules"))}," 積分規則 ",2)]),W(De,{name:"fade",mode:"out-in"},{default:Ae(()=>[(n(),i("div",{key:r.value},[r.value==="todayTask"?(n(),i("div",ze,[e("div",Ke,[t[11]||(t[11]=c(" 完成度 ")),e("span",null,l(ue.value)+"/"+l(z.value),1)]),e("div",Je,[(n(!0),i(x,null,_(q.value,(o,v)=>(n(),i("div",{class:"todayTaskItem",key:v},[e("div",We,[t[12]||(t[12]=e("img",{src:k,alt:""},null,-1)),c(" "+l(o.Name),1)]),e("div",Ze,[e("div",Qe,[o.Info=="去完成"||o.Info=="已經完成"?(n(),i("div",Xe," +"+l(o.Points),1)):m("",!0),o.Info==="已經完成"?(n(),i("img",et)):m("",!0)]),o.Info==="去完成"?(n(),i("div",tt,[e("button",{onClick:ye=>_e(o)},"去完成",8,st)])):o.Info&&o.Info!=="已經完成"?(n(),i("small",ot,l(o.Info),1)):m("",!0)])]))),128))]),t[13]||(t[13]=e("div",{class:"todayTaskHR"},null,-1)),e("h6",null,"今日可獲得總積分："+l(Re.value),1),e("div",lt,[e("div",{class:"todayProgress",style:Ne({width:ke.value+"%"})},null,4)])])):r.value==="pointRecord"?(n(),i("div",nt,[e("div",it,[e("div",at,[t[14]||(t[14]=e("img",{src:D,alt:"年份篩選"},null,-1)),e("div",{class:"monthText",onClick:t[4]||(t[4]=o=>le("point"))},l(R.value)+"年 ",1),h(e("div",ut,[(n(!0),i(x,null,_(ee.value,o=>(n(),i("div",{class:"year",key:o,onClick:v=>fe(o,"point")},l(o),9,rt))),128))],512),[[f,T.value]])]),e("div",ct,[t[15]||(t[15]=e("img",{src:D,alt:"月份篩選"},null,-1)),e("div",{class:"monthText",onClick:t[5]||(t[5]=o=>ne("point"))},l(C.value)+" 月 ",1),h(e("div",dt,[(n(!0),i(x,null,_(se.value,o=>(n(),i("div",{class:"month",key:o,onClick:v=>ie(o)},l(o)+" 月 ",9,vt))),128))],512),[[f,w.value]])])]),e("div",pt,[(n(!0),i(x,null,_(N.value,(o,v)=>(n(),i("div",{class:"pointRecordDiv",key:v},[e("div",mt,[t[17]||(t[17]=e("div",{class:"imgGroup"},[e("img",{class:"Time",src:Pe,alt:""})],-1)),e("div",gt,[e("h4",null,l(o.CreateTime),1),e("h5",null,l(o.Name),1),o.Info?(n(),i("h6",ht,[t[16]||(t[16]=e("img",{src:Ue,alt:""},null,-1)),c(" "+l(o.Info),1)])):m("",!0)])]),e("div",ft,"+"+l(o.Points),1)]))),128)),N.value.length===0?(n(),i("div",xt," 尚無積分紀錄 ")):m("",!0)])])):r.value==="exchangeRecord"?(n(),i("div",_t,[e("div",kt,[e("div",Rt,[t[18]||(t[18]=e("img",{src:D,alt:"年份篩選"},null,-1)),e("div",{class:"monthText",onClick:t[6]||(t[6]=o=>le("exchange"))},l(I.value)+"年 ",1),h(e("div",Ct,[(n(!0),i(x,null,_(he.value,o=>(n(),i("div",{class:"year",key:o,onClick:v=>xe(o)},l(o),9,yt))),128))],512),[[f,B.value]])]),e("div",Tt,[t[19]||(t[19]=e("img",{src:D,alt:"月份篩選"},null,-1)),e("div",{class:"monthText",onClick:t[7]||(t[7]=o=>ne("exchange"))},l(y.value)+" 月 ",1),h(e("div",wt,[(n(!0),i(x,null,_(oe.value,o=>(n(),i("div",{class:"month",key:o,onClick:v=>ie(o,"exchange")},l(o)+" 月 ",9,Bt))),128))],512),[[f,L.value]])])]),e("div",Lt,[(n(!0),i(x,null,_(G.value,(o,v)=>(n(),i("div",{class:"exchangeRecordDiv",key:v},[e("div",It,[t[20]||(t[20]=e("div",{class:"imageGroup"},[e("img",{src:Ye,alt:"券圖示"})],-1)),e("div",bt,[e("h4",null,l(o.CreateTime),1),e("h5",null,l(o.Name.replace("#"," "))+" 兌換完成",1),e("h6",{class:S({canUse:o.Info.includes("可立即使用"),canUseLimit:o.Info.includes("可使用日")})},[o.Info.includes("可立即使用")?(n(),i("img",St)):o.Info.includes("可使用日")?(n(),i("img",Gt)):m("",!0),c(" "+l(o.Info),1)],2)])]),e("div",At,[e("button",{onClick:ye=>ge(o)},"查看",8,Dt)])]))),128)),G.value.length===0?(n(),i("div",Mt," 尚無兌換紀錄 ")):m("",!0)])])):r.value==="pointRules"?(n(),i("div",Nt,t[21]||(t[21]=[e("div",{class:"pointRulesInfo"},[e("ul",null,[e("li",null,"雲端會員：每消費100元獲得1點積分"),e("li",null,"銀卡會員：每消費100元獲得1點積分"),e("li",null,"金卡會員：每消費100元獲得1.2點積分"),e("li",null,"鈦金會員：每消費100元獲得1.5點積分"),e("li",null,"積分價值：1點 = 台幣1元"),e("li",null,"使用範圍：積分僅限於此平台使用"),e("li",null,[c(" 有效期限：積分自獲得日起"),e("span",null,"12個月"),c("內有效，請及時使用 ")])])],-1),e("div",{class:"pointRulesListGroup"},[e("div",{class:"pointRulesList"},[e("div",{class:"pointRulesText"},[e("img",{src:k,alt:""}),e("h4",null,"使用紀錄")]),e("div",{class:"pointRulesNumber"},"+5")])],-1),e("div",{class:"pointRulesListGroup"},[e("div",{class:"pointRulesList"},[e("div",{class:"pointRulesText"},[e("img",{src:k,alt:""}),e("h4",null,"自律神經檢測")]),e("div",{class:"pointRulesNumber"},"+10")])],-1),e("div",{class:"pointRulesListGroup"},[e("div",{class:"pointRulesList"},[e("div",{class:"pointRulesText"},[e("img",{src:k,alt:""}),e("h4",null,"生活紀錄檢測")]),e("div",{class:"pointRulesNumber"},"+10")])],-1),e("div",{class:"pointRulesListGroup"},[e("div",{class:"pointRulesList"},[e("div",{class:"pointRulesText"},[e("img",{src:k,alt:""}),e("h4",null,"寶貝記錄檢測")]),e("div",{class:"pointRulesNumber"},"+10")])],-1),e("div",{class:"pointRulesListGroup"},[e("div",{class:"pointRulesList"},[e("div",{class:"pointRulesText"},[e("img",{src:k,alt:""}),e("h4",null,"點擊分享連結並完成註冊")]),e("div",{class:"pointRulesNumber"},"+100")])],-1),e("div",{class:"pointRulesListGroup"},[e("div",{class:"pointRulesList"},[e("div",{class:"pointRulesText"},[e("img",{src:k,alt:""}),e("h4",null,"完成分享後進行產品購買")]),e("div",{class:"pointRulesNumber"},"+200")])],-1)]))):m("",!0)]))]),_:1})])])]),h(e("div",Vt,[e("div",$t,l(d.value.DigitalCode||"12345678"),1),e("h4",null,l(d.value.Name.replace("#"," ")),1),t[23]||(t[23]=e("h5",null,"可用於療程商品折抵",-1)),e("div",{onClick:b,class:"verificationClose"},t[22]||(t[22]=[e("img",{src:J,alt:""},null,-1)]))],512),[[f,V.value]]),h(e("div",Pt,[t[28]||(t[28]=e("div",{class:"couponBoxImgGroup"},[e("img",{src:de,alt:""})],-1)),e("h4",null,l(d.value.Name.replace("#"," ")),1),t[29]||(t[29]=e("h5",null,"可用於療程商品折抵",-1)),e("ul",null,[e("li",null,[t[24]||(t[24]=c(" 兌換日期 ")),e("span",null,l(d.value.CreateTime),1)]),e("li",null,[t[25]||(t[25]=c(" 兌換積分 ")),e("span",null,l(d.value.AvaPoints),1)]),e("li",null,[t[26]||(t[26]=c(" 可使用日 ")),e("span",null,l(d.value.Info),1)])]),e("div",{class:"couponBoxClose",onClick:b},t[27]||(t[27]=[e("img",{src:J,alt:""},null,-1)]))],512),[[f,$.value]]),h(e("div",Ut,[t[34]||(t[34]=e("div",{class:"couponBoxImgGroup"},[e("img",{src:de,alt:""})],-1)),e("h4",null,l(d.value.Name.replace("#"," ")),1),t[35]||(t[35]=e("h5",null,"可用於療程商品折抵",-1)),e("ul",null,[e("li",null,[t[30]||(t[30]=c(" 兌換日期 ")),e("span",null,l(d.value.CreateTime),1)]),e("li",null,[t[31]||(t[31]=c(" 兌換積分 ")),e("span",null,l(d.value.AvaPoints),1)]),e("li",null,[t[32]||(t[32]=c(" 已使用日 ")),e("span",null,l(X(d.value.UseTime)),1)])]),e("div",{class:"couponBoxClose",onClick:b},t[33]||(t[33]=[e("img",{src:J,alt:""},null,-1)]))],512),[[f,P.value]]),h(e("div",{class:"pointCover",onClick:b},null,512),[[f,U.value]])],64)}}};export{Jt as default};
