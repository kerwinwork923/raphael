.face-blur-mask {
  position: absolute;
  inset: 0;
  z-index: 0;
  backdrop-filter: blur(10px);
  background: rgba(0, 0, 0, 0.25);
  pointer-events: none;
  opacity: 1;
  display: block;
  -webkit-mask-image: radial-gradient(ellipse 50% 50% at 50% 50%, transparent 40%, black 41%);
  mask-image: radial-gradient(ellipse 50% 50% at 50% 50%, transparent 40%, black 41%);
}

/* RWD 調整 */
@media screen and (max-width: 1024px) {
  .face-blur-mask {
    -webkit-mask-image: radial-gradient(ellipse 55% 55% at 50% 50%, transparent 45%, black 46%);
    mask-image: radial-gradient(ellipse 55% 55% at 50% 50%, transparent 45%, black 46%);
  }
}

@media screen and (max-width: 768px) {
  .face-blur-mask {
    -webkit-mask-image: radial-gradient(ellipse 60% 60% at 50% 50%, transparent 50%, black 51%);
    mask-image: radial-gradient(ellipse 60% 60% at 50% 50%, transparent 50%, black 51%);
  }
}

@media screen and (max-width: 576px) {
  .face-blur-mask {
    -webkit-mask-image: radial-gradient(ellipse 65% 65% at 50% 50%, transparent 55%, black 56%);
    mask-image: radial-gradient(ellipse 65% 65% at 50% 50%, transparent 55%, black 56%);
  }
} 

// 顯示到 logs
// document.getElementById("logs").innerHTML =
//   semanticBlock + reportBlock;
aiAnalysing.value = false; // 分析完畢自動隱藏

// 取得 userData
const userData = JSON.parse(localStorage.getItem("userData") || "{}");

// 組合 HRV3Save 參數
const hrv3Payload = {
  MID: userData.MID || "",
  MAID: userData.MAID || "",
  Token: userData.Token || "",
  Mobile: userData.Mobile || "",
  UID: userData.UID || "", // 若沒有 UID 就傳 ""
  HRVCalTime: userData.HRVCalTime || "",
  Flag: "", // 依需求填 "1"、"2"、"3" 或 ""
  hbr: hbr?.toString() || "",
  rmssd: hrv.RMSSD?.toString() || "",
  sdnn: sdnn?.toString() || "",
  lf: LF?.toString() || "",
  hf: HF?.toString() || "",
  lf_hf: lf_hf?.toString() || "",
  sbp: sbp?.toString() || "",
  dbp: dbp?.toString() || "",
  spo2: spo2?.toString() || "",
  af: af?.toString() || "",
  rr: rr?.toString() || "",
  fa: fa?.toString() || ""
};

// 呼叫 HRV3Save API
await saveHRV3ToServer(hrv3Payload);

// 直接跳轉到結果頁
window.location.href = "/vital/finish.html"; 