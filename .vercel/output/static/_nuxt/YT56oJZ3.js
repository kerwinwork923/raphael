import{_ as G}from"./-OuEz4cf.js";import{_ as F}from"./C4EKiFTB.js";import{a as Q}from"./CCb-kr4I.js";import{J as X,r as d,i as Y,g as Z,M as j,v as n,z as L,x as e,O as B,K as v,L as y,U as f,Q as $,R as tt,y as r,X as M,t as a,B as et,N as H}from"./D70xjexz.js";import{_ as ot}from"./B0rTVoH9.js";import{_ as P}from"./CR27s-ts.js";import{_ as lt,a as st,b as at,c as nt,d as rt}from"./D0XVPD9N.js";import{_ as it}from"./DlAUqK2U.js";const ct={components:{RaphaelLoading:G,TitleMenu:F},setup(){const c=X(),t=d(!1),g=d(!1),o=d([]),C=d(!1),x=d("contractList"),_=d(null);function h(){var u,p;const s=(p=(u=_.value)==null?void 0:u.$el)==null?void 0:p.querySelector("input");s&&s.click()}const m=d([]),l=s=>{if(!s)return"";const u=new Date(s),p=u.getFullYear(),q=String(u.getMonth()+1).padStart(2,"0"),K=String(u.getDate()).padStart(2,"0");return`${p}/${q}/${K}`},i=["雙效紅光活力衣","三效深眠衣","全效調節衣","居家治療儀"],k=["進行中","已到期"],S=d(null),T=d(null);function N(){t.value=!t.value,g.value=!1}function w(){g.value=!g.value,t.value=!1}function I(s){S.value=s,t.value=!1}function U(s){T.value=s,g.value=!1}const R=localStorage.getItem("userData"),{MID:D,Token:b,MAID:A,Mobile:V,Name:E}=R?JSON.parse(R):{};if(!D||!b||!A||!V){localStorage.removeItem("userData"),c.push("/");return}else if(E===""){c.push("/changeMember");return}(async()=>{try{C.value=!0;const s=await Q.post("https://23700999.com:8081/HMA/API_Contract.jsp",{MID:D,Token:b,MAID:A,Mobile:V});s.status===200&&(o.value=s.data.ContractList,console.log("contractList:",o.value))}catch(s){console.error(s)}finally{C.value=!1}})();const O=Y(()=>o.value.filter(s=>{const u=!S.value||s.ProductName===S.value;let p=!0;return T.value==="進行中"?p=s.Still>0:T.value==="已到期"&&(p=s.Still<=0),u&&p})),W=s=>s?s.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):"0",z=s=>{s.length>5?(m.value=s.slice(0,5),alert("最多只能請五天假！")):m.value=s},J=d(!1);return{loading:C,productBoxVisible:t,stateBoxVisible:g,contractList:o,selectedProduct:S,selectedState:T,productOptions:i,stateOptions:k,toggleProductBox:N,toggleStateBox:w,onSelectProduct:I,onSelectState:U,filteredContracts:O,toThousands:W,selectedDates:m,formatDate:l,handleDateChange:z,activeTab:x,leaveProductBoxVisible:J,myHiddenPicker:_,openMyDatePicker:h}}},dt={key:1,class:"contractWrap"},vt={class:"typeChangeTag"},ut={class:"leaveApplicationAlert"},pt={class:"leaveDateGroup"},gt={key:0,class:"limitError"},mt={class:"leaveApplicationAlertBtnGroup"},yt={key:2,class:"contractListWrap"},ft={class:"contractTopMenu"},Ct={class:"contractTopMenuItem",style:{"border-radius":"12px 0 0 12px"}},_t={key:0,class:"productBox"},kt=["onClick"],St={class:"contractTopMenuItem",style:{"border-radius":"0 12px 12px 0"}},Tt={key:0,class:"stateBox"},Pt=["onClick"],ht={class:"contractContentGroup"},Bt={class:"contractContentTitleGroup"},xt={class:"contractContentTitleTag"},Rt={class:"contractPrice"},Dt={class:"linkGroup"},bt=["href"],At={class:"progressGroup"},Vt={class:"contractProgress"},Lt={class:"contractProgressTextGroup"},Mt={class:"contractProgressBarGroup"},Ht={class:"contractDayGroup"},Gt={class:"startTimeGroup"},Ft={key:0,src:nt,alt:"contract time"},Nt={key:1,src:rt,alt:"contract warning"},wt={class:"endTimeGroup"},It={key:3,class:"leaveHistoryRecordWrap"},Ut={class:"leaveHistoryRecordFilterGroup"},Et={class:"leaveHistoryRecordFilter"},Ot={key:0,class:"leaveHistoryRecordTopProduct"},Wt=["onClick"];function zt(c,t,g,o,C,x){const _=G,h=F,m=Z("VueDatePicker");return o.loading?(a(),j(_,{key:0})):(a(),n("div",dt,[L(h,{Text:"合約|請假",link:"/user"}),e("div",vt,[e("h2",{class:B({typeChangeTagActive:o.activeTab==="contractList"}),onClick:t[0]||(t[0]=l=>o.activeTab="contractList")}," 合約列表 ",2),e("h2",{class:B({typeChangeTagActive:o.activeTab==="leaveHistoryRecord"}),onClick:t[1]||(t[1]=l=>o.activeTab="leaveHistoryRecord")}," 請假歷史紀錄 ",2)]),v("",!0),v("",!0),e("div",ut,[t[15]||(t[15]=e("h3",null,"請假申請",-1)),t[16]||(t[16]=e("div",{class:"leaveApplicationAlertHR"},null,-1)),t[17]||(t[17]=e("h4",null,"請假日期",-1)),L(m,{ref:"myHiddenPicker",modelValue:o.selectedDates,"onUpdate:modelValue":[t[2]||(t[2]=l=>o.selectedDates=l),o.handleDateChange],"multi-dates":"",teleport:"body","cancel-text":"取消","select-text":"確定",locale:"zh-TW","no-today":"","enable-time-picker":!1,class:"invisibleDatePicker"},null,8,["modelValue","onUpdate:modelValue"]),e("div",{class:"leaveDates",onClick:t[3]||(t[3]=(...l)=>o.openMyDatePicker&&o.openMyDatePicker(...l))},[t[13]||(t[13]=e("img",{src:ot,alt:""},null,-1)),e("div",pt,[(a(!0),n(y,null,f(o.selectedDates,(l,i)=>(a(),n("div",{class:"leaveDate",key:i},r(o.formatDate(l)),1))),128))])]),t[18]||(t[18]=e("hr",null,null,-1)),o.selectedDates.length>5?(a(),n("div",gt," 一個月最多請五天 ")):v("",!0),t[19]||(t[19]=e("h4",null,"請假原因",-1)),$(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=l=>c.leaveReason=l),class:"noResizeTextarea",placeholder:"請簡短說明..."},null,512),[[tt,c.leaveReason]]),e("p",null,"合約起迄日："+r(c.contractStart)+" ~ "+r(c.contractEnd),1),e("p",null,"合約到期日："+r(c.contractExpire),1),e("p",null,"請假申請天數："+r(o.selectedDates.length)+" 天",1),e("p",null,"剩餘請假天數："+r(5-o.selectedDates.length)+" 天",1),e("div",mt,[t[14]||(t[14]=e("div",{class:"leaveApplicationAlertBackBtn"},"返回",-1)),e("div",{class:"leaveApplicationAlertSumbitBtn",onClick:t[5]||(t[5]=(...l)=>c.submitLeaveApplication&&c.submitLeaveApplication(...l))},"送出")])]),o.activeTab==="contractList"?(a(),n("div",yt,[e("div",ft,[e("div",Ct,[e("div",{class:"contractTopMenuTextBox",onClick:t[6]||(t[6]=(...l)=>o.toggleProductBox&&o.toggleProductBox(...l))},[t[20]||(t[20]=e("img",{src:P,alt:""},null,-1)),e("h4",null,r(o.selectedProduct?o.selectedProduct:"所有產品"),1)]),o.productBoxVisible?(a(),n("div",_t,[e("div",{class:"contractTopProduct",onClick:t[7]||(t[7]=l=>o.onSelectProduct(null))}," 所有產品 "),(a(!0),n(y,null,f(o.productOptions,(l,i)=>(a(),n("div",{class:"contractTopProduct",key:i,onClick:k=>o.onSelectProduct(l)},r(l),9,kt))),128))])):v("",!0)]),e("div",St,[e("div",{class:"contractTopMenuTextBox",onClick:t[8]||(t[8]=(...l)=>o.toggleStateBox&&o.toggleStateBox(...l))},[t[21]||(t[21]=e("img",{src:P,alt:""},null,-1)),e("h4",null,r(o.selectedState?o.selectedState:"所有狀態"),1)]),o.stateBoxVisible?(a(),n("div",Tt,[e("div",{class:"contractTopState",onClick:t[9]||(t[9]=l=>o.onSelectState(null))}," 所有狀態 "),(a(!0),n(y,null,f(o.stateOptions,(l,i)=>(a(),n("div",{class:"contractTopState",key:i,onClick:k=>o.onSelectState(l)},r(l),9,Pt))),128))])):v("",!0)])]),e("div",ht,[(a(!0),n(y,null,f(o.filteredContracts,(l,i)=>(a(),n("div",{class:"contractContent",key:i},[e("div",Bt,[e("h3",null,r(l.ProductName),1),e("div",xt,[t[22]||(t[22]=e("img",{src:lt,alt:""},null,-1)),e("div",Rt,r(o.toThousands(l.TotalFee)),1)])]),e("div",Dt,[l.PdfFileName?(a(),n("a",{key:0,href:l.PdfFileName,target:"_blank",rel:"noopener noreferrer"},t[23]||(t[23]=[et(" 查看內容 "),e("span",null,[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"15",height:"15",viewBox:"0 0 18 18",fill:"#74BC1F"},[e("path",{d:"M6.65764 3.75271L12.7476 10.0002L6.65764 16.2477C6.54862 16.3593 6.48758 16.5092 6.48758 16.6652C6.48758 16.8212 6.54862 16.9711 6.65764 17.0827C6.7106 17.1368 6.77381 17.1797 6.84356 17.209C6.91332 17.2383 6.98823 17.2534 7.06389 17.2534C7.13956 17.2534 7.21447 17.2383 7.28422 17.209C7.35398 17.1797 7.41719 17.1368 7.47014 17.0827L13.9501 10.4365C14.0639 10.3197 14.1276 10.1632 14.1276 10.0002C14.1276 9.83722 14.0639 9.68068 13.9501 9.56396L7.47139 2.91771C7.4184 2.86328 7.35504 2.82002 7.28505 2.79048C7.21506 2.76094 7.13986 2.74572 7.06389 2.74572C6.98793 2.74572 6.91273 2.76094 6.84274 2.79048C6.77275 2.82002 6.70939 2.86328 6.65639 2.91771C6.54737 3.02933 6.48633 3.17917 6.48633 3.33521C6.48633 3.49124 6.54737 3.64109 6.65639 3.75271L6.65764 3.75271Z",fill:"#74BC1F"})])],-1)]),8,bt)):v("",!0)]),e("div",At,[e("div",Vt,[e("div",Lt,[l.Still>0&&l.UsedRatio>0&&l.UsedRatio<100?(a(),n("div",{key:0,class:"todayIcon",style:H({left:l.UsedRatio+"%"})}," 今天 ",4)):v("",!0)]),e("div",Mt,[e("div",{class:"contractProgressBar",style:H({width:l.UsedRatio+"%",backgroundColor:l.Still>0?"#1FBCB3":"#EC4F4F"})},null,4)])])]),e("div",Ht,[e("div",Gt,[t[24]||(t[24]=e("h6",null,"開始時間",-1)),e("h5",null,r(l.RentStart),1)]),e("div",{class:B(["contractDayWarn",{contractDayWarn2:l.Still<=0}])},[l.Still>0?(a(),n("img",Ft)):(a(),n("img",Nt)),e("h5",null,r(l.Info),1)],2),e("div",wt,[t[25]||(t[25]=e("h6",null,"到期日期",-1)),e("h5",null,r(l.RentEnd),1)])]),t[26]||(t[26]=M('<div class="leaveGroup"><div class="leaveRecordBtn"><img src="'+st+'" alt=""> 請假紀錄 </div><div class="leaveApplication"><img src="'+at+'" alt=""> 請假申請 </div></div>',1))]))),128))])])):v("",!0),o.activeTab==="leaveHistoryRecord"?(a(),n("div",It,[e("div",Ut,[e("div",Et,[t[27]||(t[27]=e("img",{src:P,alt:""},null,-1)),e("h4",{onClick:t[10]||(t[10]=l=>o.leaveProductBoxVisible=!o.leaveProductBoxVisible)}," 產品類型 "),o.leaveProductBoxVisible?(a(),n("div",Ot,[(a(!0),n(y,null,f(o.productOptions,(l,i)=>(a(),n("div",{key:i,onClick:k=>o.onSelectProduct(l)},r(l),9,Wt))),128))])):v("",!0)]),t[28]||(t[28]=e("div",{class:"leaveHistoryRecordFilter"},[e("img",{src:P,alt:""}),e("h4",null,"查詢請假日期或區間")],-1))]),t[29]||(t[29]=M('<div class="leaveHistoryRecordSubTitle"> 總共 <span>10</span> 筆紀錄 </div><div class="leaveHistoryRecordContentGroup"><div class="leaveHistoryRecordContent"><h3>產品名稱 第N期</h3><div class="leaveHistoryRecordRow"><h4>請假日期</h4><ul><li>2024/10/10</li><li>2024/10/12</li><li>2024/10/20</li></ul></div><div class="leaveHistoryRecordRow"><h4>請假天數</h4><p>3</p></div><div class="leaveHistoryRecordRow"><h4>請假原因</h4><p>原因原因原因原因原因原因原因原因原因原因原因原因原因</p></div></div></div>',2))])):v("",!0)]))}const te=it(ct,[["render",zt]]);export{te as default};
