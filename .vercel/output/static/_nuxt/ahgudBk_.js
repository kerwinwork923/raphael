import{_ as F}from"./-OuEz4cf.js";import{_ as q,a as E,b as P}from"./D8eXa2nx.js";import{D as O}from"./BWZ9gJ2c.js";import{_ as j}from"./C4EKiFTB.js";import{J as re,r as m,i as b,o as ce,v as d,M as w,K as v,z as B,x as e,X as ue,y as k,Q as Y,T as G,L as S,U as V,t as i}from"./D70xjexz.js";import{a as me}from"./CCb-kr4I.js";import{u as ve}from"./t-MFjoUR.js";import{_ as A}from"./CR27s-ts.js";import{_ as fe}from"./fh2N3Yhm.js";import{_ as he}from"./DlAUqK2U.js";import"./DNAPM-2u.js";import"./B0rTVoH9.js";import"./Di88QSaI.js";function M(s){if(!s||s.length<14)return null;const o=Number(s.slice(0,4)),D=Number(s.slice(4,6))-1,t=Number(s.slice(6,8)),p=Number(s.slice(8,10)),f=Number(s.slice(10,12)),r=Number(s.slice(12,14));return new Date(o,D,t,p,f,r)}function ge(s){if(!s)return"";if(s.includes("/")||s.length<12)return s;const o=Number(s.slice(0,4)),D=Number(s.slice(4,6))-1,t=Number(s.slice(6,8)),p=Number(s.slice(8,10)),f=Number(s.slice(10,12)),r=new Date(o,D,t,p,f);if(isNaN(r.getTime()))return s;const C=r.getMonth()+1,g=r.getDate(),_=String(r.getHours()).padStart(2,"0"),c=String(r.getMinutes()).padStart(2,"0");return`${C}/${g} ${_}:${c}`}const _e={name:"UsageHistoryView",components:{TitleMenu:j,TimeRing:q,TimeRing2:E,DSPRSelect:O,HRVAlertForUse:P,RaphaelLoading:F},setup(){const s=re();ve();const o=decodeURIComponent(s.currentRoute.value.params.clothType||"");["三效深眠衣","雙效紅光活力衣","全效調節衣","居家治療儀"].includes(o)||s.push("/usageHistory");const t=m(!1),p=m(o),f=m([]),r=m("00:00:00"),C=m([]),g=m(new Date().getFullYear()),_=m(new Date().getMonth()+1),c=m(!1),h=m(!1),a=b(()=>{const n=new Date().getFullYear(),l=[];for(let u=2024;u<=n;u++)l.push(u);return l}),R=Array.from({length:12},(n,l)=>l+1).reverse();function I(){c.value=!c.value,h.value=!1}function J(){h.value=!h.value,c.value=!1}function W(n){g.value=n,c.value=!1}function z(n){_.value=n,h.value=!1}async function K(){var n;try{t.value=!0;const l=localStorage.getItem("userData");if(!l){s.push("/");return}const{MID:u,Token:oe,MAID:se,Mobile:ae}=JSON.parse(l),H=await me.post("https://23700999.com:8081/HMA/API_UseStart_Data.jsp",{MID:u,Token:oe,MAID:se,Mobile:ae});if(H.status===200&&((n=H.data)!=null&&n.UseRecord)){const x=H.data.UseRecord.filter(y=>y.ProductName===o);if(f.value=x,x.length>0){const y=x[x.length-1],N=M(y.oriStartTime),U=M(y.oriEndTime);if(N&&U&&U>N){const L=Math.floor((U-N)/1e3),le=String(Math.floor(L/3600)).padStart(2,"0"),ie=String(Math.floor(L%3600/60)).padStart(2,"0"),de=String(L%60).padStart(2,"0");r.value=`${le}:${ie}:${de}`}}const ne=new Date,T=new Date;T.setHours(5,0,0,0),ne<T&&T.setDate(T.getDate()-1),C.value=x.filter(y=>new Date(y.EndTime.replace(/\//g,"-"))>=T)}}catch(l){console.error("getUseRecord error:",l)}finally{t.value=!1}}function Q(n){const l=M(n.oriStartTime),u=M(n.oriEndTime);return!l||!u||u<=l?0:Math.round((u-l)/6e4)}const X=b(()=>f.value.filter(n=>{const l=M(n.oriStartTime);return!l||isNaN(l.getTime())?!1:l.getFullYear()===g.value&&l.getMonth()+1===_.value}));function Z(n){s.push(`/usageHRVResult/${n.UID}`)}function $(n){s.push(`/healthData/${n}`)}function ee(){}function te(){}return ce(()=>{K()}),{loading:t,productName:o,usageCardState:p,hasDetectTime:r,todayUseRecord:C,selectedYear:g,selectedMonth:_,yearBoxVisible:c,monthBoxVisible:h,displayYears:a,months:R,toggleYearBox:I,toggleMonthBox:J,selectYear:W,selectMonth:z,useData:f,filteredUseList:X,calcUsedMinutes:Q,formatTimestamp3:ge,handleDetectClick:Z,handleWatchClick:$,handleCountdownComplete:ee,handleHRVCheck:te}}},pe={class:"usageWrap"},Ce={key:3,class:"usageInfoGroup"},ye={key:4,class:"usageInfoGroup"},ke={key:5,class:"usageInfoGroup"},De={key:6,class:"usageInfoGroup"},Re={class:"usageRecord"},xe={class:"detectSelectGroup"},Te={class:"yearSelectGroup"},Me={class:"yearBox"},Ne=["onClick"],we={class:"monthSelectGroup"},Se={class:"monthBox"},Ie=["onClick"],He={class:"integrationGroup"},Ue={class:"detect"},Le={class:"timeGroup"},Be={class:"timeTextGroup"},Ve={class:"time"},be={class:"timeInfoText"},Ye={class:"infoGroup"},Ge=["onClick"],Ae=["onClick"],Fe={key:0,class:"notDetectData"};function qe(s,o,D,t,p,f){const r=F,C=P,g=O,_=j,c=E,h=q;return i(),d(S,null,[t.loading?(i(),w(r,{key:0})):v("",!0),B(C,{showCloseButton:!0}),B(g,{showCloseButton:!1}),e("div",pe,[B(_,{Text:"穿衣紀錄",link:"/UsageHistory"}),t.productName==="三效深眠衣"||t.productName==="全效調節衣"?(i(),w(c,{key:0,productName:t.productName,hasDetectRecord:!1,todayUseRecord:t.todayUseRecord,hasDetectTime:t.hasDetectTime},null,8,["productName","todayUseRecord","hasDetectTime"])):v("",!0),t.productName==="居家治療儀"?(i(),w(h,{key:1,totalTime:3e3,"product-name":t.productName,hasTodayRecord:!1,onCountdownComplete:t.handleCountdownComplete,onRequireHRVCheck:t.handleHRVCheck},null,8,["product-name","onCountdownComplete","onRequireHRVCheck"])):v("",!0),t.productName==="雙效紅光活力衣"?(i(),w(h,{key:2,totalTime:5400,"product-name":t.productName,hasTodayRecord:!1,onCountdownComplete:t.handleCountdownComplete,onRequireHRVCheck:t.handleHRVCheck},null,8,["product-name","onCountdownComplete","onRequireHRVCheck"])):v("",!0),t.usageCardState==="雙效紅光活力衣"?(i(),d("div",Ce,o[2]||(o[2]=[ue('<div class="usageInfoCard" data-v-4212d0f8><h3 data-v-4212d0f8>電量提示燈使用說明</h3><div class="item" data-v-4212d0f8><span class="greenLight" data-v-4212d0f8>•綠燈恆亮</span><div class="text" data-v-4212d0f8>正常電量</div></div><div class="item" data-v-4212d0f8><span class="greenLight" data-v-4212d0f8>•綠燈閃爍</span><div class="text" data-v-4212d0f8>充電中，需充滿4小時</div></div><div class="item" data-v-4212d0f8><span class="redLight" data-v-4212d0f8>•紅燈恆亮</span><div class="text" data-v-4212d0f8>電量剩餘25% (治療完需充電)</div></div><div class="item" data-v-4212d0f8><span class="redLight" data-v-4212d0f8>•紅燈閃爍</span><div class="text" data-v-4212d0f8>電量剩餘5% (不計治療次數)</div></div></div><div class="usageInfoCard" data-v-4212d0f8><h3 data-v-4212d0f8>提示音說明</h3><div class="item" data-v-4212d0f8><span class="greenLight" data-v-4212d0f8>•開始</span><div class="text" data-v-4212d0f8>1短聲</div></div><div class="item" data-v-4212d0f8><span class="redLight" data-v-4212d0f8>•結束</span><div class="text" data-v-4212d0f8>長音間隔1分鐘</div></div><div class="item" data-v-4212d0f8><span class="orangeLight" data-v-4212d0f8>•合約到期/次數用完</span><div class="text" data-v-4212d0f8>長音間隔1分鐘，紅綠燈交替閃爍</div></div></div>',2)]))):v("",!0),t.usageCardState==="三效深眠衣"?(i(),d("div",ye,o[3]||(o[3]=[e("div",{class:"usageInfoCard"},[e("h3",null,"量身訂製"),e("p",null,"依照您的健康狀況製作客製化調節貼片位置。")],-1),e("div",{class:"usageInfoCard"},[e("h3",null,"持續調節"),e("p",null,"將三效深眠衣取代睡衣，每日穿著，持續調節自律神經生理機能。")],-1),e("div",{class:"usageInfoCard"},[e("h3",null,"洗滌維護"),e("p",null,"可以直接手洗、或放置洗衣袋隨一般衣物清洗(勿加漂白水)。")],-1)]))):v("",!0),t.usageCardState==="居家治療儀"?(i(),d("div",ke,o[4]||(o[4]=[e("div",{class:"usageInfoCard"},[e("h3",null,"安全模式啟動"),e("p",null," 如果治療過程中遇到問題，設備會進入安全模式，使用者可以按下「解除」鍵，排除問題後繼續使用。 ")],-1),e("div",{class:"usageInfoCard"},[e("h3",null,"貼片脫落提示"),e("p",null," 當設備提示貼片可能脫落時，應根據示意圖檢查貼片位置，並在確認貼好後按下「解除」鍵繼續治療。 ")],-1)]))):v("",!0),t.usageCardState==="全效調節衣"?(i(),d("div",De,o[5]||(o[5]=[e("div",{class:"usageInfoCard"},[e("h3",null,"非侵入性治療"),e("p",null," 這款全效調節衣使用的是物理性治療，不涉及任何藥物，適合那些想要避免藥物副作用的患者。它依賴於專利技術的貼片，通過波頻影響神經系統 ")],-1),e("div",{class:"usageInfoCard"},[e("h3",null,"針對自律神經問題設計"),e("p",null," 全效調節衣專為改善自律神經失調而設計，適用於失眠、焦慮、情緒不穩定等問題，也能幫助增強免疫系統 ")],-1),e("div",{class:"usageInfoCard"},[e("h3",null,"適合居家使用"),e("p",null," 全效調節衣是一款設計簡單、方便的保健產品，適合在家中進行日常使用，無需到診所即可完成自律神經的調節 ")],-1)]))):v("",!0),e("div",Re,[e("div",xe,[e("div",Te,[o[6]||(o[6]=e("img",{src:A,alt:"年份篩選"},null,-1)),e("div",{class:"monthText",onClick:o[0]||(o[0]=(...a)=>t.toggleYearBox&&t.toggleYearBox(...a))},k(t.selectedYear)+"年 ",1),Y(e("div",Me,[(i(!0),d(S,null,V(t.displayYears,a=>(i(),d("div",{class:"year",key:a,onClick:R=>t.selectYear(a)},k(a),9,Ne))),128))],512),[[G,t.yearBoxVisible]])]),e("div",we,[o[7]||(o[7]=e("img",{src:A,alt:"月份篩選"},null,-1)),e("div",{class:"monthText",onClick:o[1]||(o[1]=(...a)=>t.toggleMonthBox&&t.toggleMonthBox(...a))},k(t.selectedMonth)+"月份 ",1),Y(e("div",Se,[(i(!0),d(S,null,V(t.months,a=>(i(),d("div",{class:"month",key:a,onClick:R=>t.selectMonth(a)},k(a)+"月 ",9,Ie))),128))],512),[[G,t.monthBoxVisible]])])]),e("div",He,[(i(!0),d(S,null,V(t.filteredUseList,(a,R)=>(i(),d("div",{class:"detectItem",key:R},[e("div",Ue,[e("div",Le,[o[8]||(o[8]=e("div",{class:"timeIcon",style:{cursor:"pointer"}},[e("img",{src:fe,alt:"查看健康數據"})],-1)),e("div",Be,[e("div",Ve,k(t.formatTimestamp3(a.oriStartTime)),1),e("div",be," 總共使用 "+k(t.calcUsedMinutes(a))+" 分鐘 ",1)])]),e("div",Ye,[e("div",{class:"resultText",style:{cursor:"pointer"},onClick:I=>t.handleDetectClick(a)}," 分析結果 ",8,Ge),(i(),d("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",style:{cursor:"pointer"},onClick:I=>t.handleDetectClick(a)},o[9]||(o[9]=[e("path",{d:"M5.99159 3.37719L11.4726 8.99994L5.99159 14.6227C5.89346 14.7232 5.83853 14.858 5.83853 14.9984C5.83853 15.1389 5.89346 15.2737 5.99159 15.3742C6.03925 15.4228 6.09613 15.4615 6.15891 15.4879C6.2217 15.5142 6.28911 15.5278 6.35721 15.5278C6.42531 15.5278 6.49273 15.5142 6.55551 15.4879C6.61829 15.4615 6.67518 15.4228 6.72284 15.3742L12.5548 9.39257C12.6572 9.28752 12.7145 9.14664 12.7145 8.99994C12.7145 8.85325 12.6572 8.71236 12.5548 8.60732L6.72396 2.62569C6.67627 2.57671 6.61924 2.53777 6.55625 2.51119C6.49326 2.4846 6.42558 2.4709 6.35721 2.4709C6.28884 2.4709 6.22116 2.4846 6.15817 2.51119C6.09518 2.53777 6.03816 2.57671 5.99046 2.62569C5.89234 2.72615 5.8374 2.86101 5.8374 3.00144C5.8374 3.14187 5.89234 3.27673 5.99046 3.37719Z",fill:"#666666"},null,-1)]),8,Ae))])])]))),128)),t.filteredUseList.length===0?(i(),d("div",Fe," 無檢測資料 ")):v("",!0)])])])],64)}const ot=he(_e,[["render",qe],["__scopeId","data-v-4212d0f8"]]);export{ot as default};
